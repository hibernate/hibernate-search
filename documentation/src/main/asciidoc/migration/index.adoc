// SPDX-License-Identifier: Apache-2.0
// Copyright Red Hat Inc. and Hibernate Authors
= Hibernate Search {hibernateSearchVersion}: Migration Guide from {hibernateSearchPreviousStableVersionShort}
:doctype: book
:revdate: {docdate}
:sectanchors:
:anchor:
:toc: left
:toclevels: 4
:docinfodir: {docinfodir}
:docinfo: shared,private
:title-logo-image: image:hibernate_logo_a.png[align=left,pdfwidth=33%]
:html-meta-description: Hibernate Search, full text search for your entities - Migration Guide
:html-meta-keywords: hibernate, search, hibernate search, full text, lucene, elasticsearch, opensearch
:html-meta-canonical-link: https://docs.jboss.org/hibernate/search/{hibernateSearchVersionShort}/migration/html_single/
:html-meta-version-family: {hibernateSearchVersionShort}

[[introduction]]
== [[_introduction]] Introduction

The aim of this guide is to assist you migrating
an existing application using any version `{hibernateSearchPreviousStableVersionShort}.x` of Hibernate Search
to the latest of the `{hibernateSearchVersionShort}.x` series.

NOTE: If you think something is missing or something does not work, please link:https://hibernate.org/community[contact us].

If you're looking to migrate from an earlier version,
you should migrate step-by-step, from one minor version to the next,
following the migration guide of link:https://hibernate.org/search/documentation/migrate/[each version].

[WARNING]
====
**To Hibernate Search 5 users**

Be aware that a lot of APIs have changed since Hibernate Search 5, some only because of a package change,
others because of more fundamental changes
(like moving away from using Lucene types in Hibernate Search APIs).

When migrating from Hibernate Search 5, you are encouraged to migrate first to Hibernate Search 6.0
using the https://docs.jboss.org/hibernate/search/6.0/migration/html_single/[6.0 migration guide],
and only then to later versions (which will be significantly easier).
====

[[requirements]]
== Requirements

The requirements of Hibernate Search {hibernateSearchVersion}
are the same as those of Hibernate Search {hibernateSearchPreviousStableVersionShort}.

[[artifact-changes]]
== Artifacts

The coordinates of Maven artifacts in Hibernate Search {hibernateSearchVersion}
are the same as in Hibernate Search {hibernateSearchPreviousStableVersionShort}.

A few new artifacts are introduced with this version. They are for the pluggable Elasticsearch backend REST clients.
While for now, the Elasticsearch backend brings the default (Elasticsearch low level client (based on Apache HTTP client 4))
dependency automatically, it is recommended to explicitly specify the client dependency you want to use moving forward.
Currently available options are:

* `org.hibernate.search:hibernate-search-backend-elasticsearch-client-rest4` backed by `org.elasticsearch.client:elasticsearch-rest-client`
* `org.hibernate.search:hibernate-search-backend-elasticsearch-client-rest5` backed by `co.elastic.clients:elasticsearch-rest5-client`
* `org.hibernate.search:hibernate-search-backend-elasticsearch-client-opensearch-rest` backed by `org.opensearch.client:opensearch-rest-client`

[[data-format]]
== Data format and schema

[[indexes]]
=== Indexes

The index format and schema in Hibernate Search {hibernateSearchVersion}
is backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}:
older indexes can be read from and written to without reindexing.

[[outboxpolling]]
=== Outbox polling database tables

The event and agent database tables used for
link:https://docs.jboss.org/hibernate/search/{hibernateSearchVersionShort}/reference/en-US/html_single/#coordination-database-polling[outbox-polling]
in Hibernate Search {hibernateSearchVersion}
are backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}:
no database schema update is necessary for these tables.

[[configuration]]
== Configuration

The configuration properties in Hibernate Search {hibernateSearchVersion}, in general,
are backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}.

[[api]]
== API

The https://hibernate.org/community/compatibility-policy/#code-categorization[API]
in Hibernate Search {hibernateSearchVersion}
is, in general, backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}.
However, some elements are now deprecated:

* `org.hibernate.search.backend.elasticsearch.client.ElasticsearchHttpClientConfigurer` is deprecated for removal.
With introduction of the pluggable Elasticsearch backend clients, configurers are a part of the particular client
and expose client-specific configuration knobs. To keep using the Elasticsearch low level based REST client (Apache HTTP Client 4)
switch to `org.hibernate.search.backend.elasticsearch.client.rest4.ElasticsearchHttpClientConfigurer`
* `org.hibernate.search.backend.elasticsearch.client.ElasticsearchHttpClientConfigurationContext` is also up for removal,
as it's a part of the configurer API.

[[spi]]
== SPI

The https://hibernate.org/community/compatibility-policy/#code-categorization[SPI]
in Hibernate Search {hibernateSearchVersion}
is, in general, backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}.

[[behavior]]
== Behavior

The behavior of Hibernate Search {hibernateSearchVersion}
is, in general, backward-compatible with Hibernate Search {hibernateSearchPreviousStableVersionShort}.
